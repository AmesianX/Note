## TCP/IP协议

传输控制协议，Internet国际互联网最基本的协议

基于OSI模型，分为链路层、网络层（IP协议）、传输层（TCP、UDP）和应用层

HTTP请求中，在应用层中发送端将用户数据发送到传输层，此时拼接上TCP首部，发送到传输层，此时拼接上IP首部，传输到链路层，此时拼接上以太网首部，接收端接收到报文后，反向层层解析

### Ping

通过IP协议中的ICMP回显请求报文（非UDP）发送给目标主机，检测目标主机是否可以连通，应答返回字节数、反应时间、生存时间

### Tracert

探测路由的命令，可以看到IP数据到达目的地所经过的路由

### TCP和UDP的区别

TCP和UDP是传输层的不同实现方式的协议

TCP

- 可靠
- 面向连接
- 传输效率低
- 有重传、确认等机制
- 在对网络通讯质量有要求的时候使用

UDP

- 不可靠
- 面向无连接
- 传输效率高
- 不保证数据包顺序
- 在对网络通讯速度有要求的使用

### TCP 3次握手

![](https://raw.githubusercontent.com/TruthKeeper/Note/master/Http/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.jpg)

**第一次握手**：客户端发送一个SYN包（SYN标志位为1），并且包头的序列号seq为一个随机数 **X**

**第二次握手**：服务端接收到数据包后通过SYN=1知道客户端想要建立连接，发送一个应答包（SYN标志位为1，ACK标志位1），ack字段为 **X+1**，seq为一个随机数 **Y**

**第三次握手**：客户端收到服务端的应答包后判断ACK标志是否为1，且ack字段是否为 **X+1**，如果正确则发送一个确认包（SYN标志为0，ACK标志为1），ack字段为 **Y+1**，服务端确认正确后则完成三次握手

> 为什么需要3次握手

防止已经失效的客户端请求被服务端接收到，建立错误的连接

### TCP 4次挥手

![](https://raw.githubusercontent.com/TruthKeeper/Note/master/Http/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.jpg)

**第一次挥手**：客户端发送一个FIN包（FIN标志为1），sqe序列号为随机数 **X**

**第二次挥手**：服务端收到FIN包后，发送应答包（ACK标志为1），ack字段为 **X+1**，seq序列号为随机数**Y**

**第三次挥手**：服务端其余请求报文全部应答后，发送一个FIN包（FIN标志为1，ACK标志为1），ack字段为**X+1**，seq序列号为**Z**

**第四次挥手**：客户端确认无误后，发送一个确认包（ACK标志为1），ack字段为**Z+1**，seq为**X+1**

> 为什么需要4次挥手

服务端收到FIN包后，代表客户端没有数据要发送了，但是服务端之前的数据未必全部已经响应完毕了，所以需要2次报文响应，分别是确认收到FIN和所有报文响应完毕

### DNS

Domain Name System，域名解析系统，IP实际寻址方式，在UDP协议之上，在Internet上作为域名和IP地址相互映射的一个分布式数据库，通过主机名来获取到分配的IP地址

DNS劫持就是指拦截正常的DNS请求，返回假的IP地址或者不响应请求






